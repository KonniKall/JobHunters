{% load static %}

{%block content%}
    <html>
      <head>
        <title>Job Hunters - Sign In</title>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>-->
           
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

        <link rel="stylesheet" type="text/css" href="{% static 'css/sign-in.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
        <script src="https://malsup.github.io/jquery.form.js"></script> 

        {% if user.is_authenticated %}
            <script> 
                window.location.href = '/';
            </script>
        {% endif %}
    </head>
      <body>
          <section class="loginSection" id="login">
            <div class="loginSectionTitle">
                <p class="loginSectionTitleText">Sign in</p>
                <div class="login_error" style="display: none;">
                    <p>Error</p>
                    <span>
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                            <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
                        </svg>
                    </span>
                </div>
            </div>
                            
                <form method="POST" class="login_form" action="">
                    {% csrf_token %}
                    {% comment %} 
                      {{ form|crispy }}
                    {% endcomment %}

                    <div class="field">
                        <input type="text" required autocomplete="off" id="username" name="username">
                        <label for="username" title="Username" data-title="Username" style="pointer-events: none;"></label>
                        
                    </div>
                    
                    
                    <div class="field">
                        <input style="padding-right: 48px;" type="password" required autocomplete="off" id="password" name="password">
                        <label for="password" title="Password" data-title="Password" style="pointer-events: none;"></label>
                        <span class="password_span" onclick="password_show_hide();">
                            <svg style="display: none;" id="hide_eye" width="20" height="20" fill="#777" viewBox="0 0 16 16">
                                <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
                                <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
                            </svg>
                            <svg style="display: block;" id="show_eye" width="20" height="20" fill="#777" viewBox="0 0 16 16">
                                <path d="m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7.029 7.029 0 0 0 2.79-.588zM5.21 3.088A7.028 7.028 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474L5.21 3.089z"/>
                                <path d="M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829l-2.83-2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12-.708.708z"/>
                            </svg>
                        </span>
                        
                    </div>
                    <div class="form-group">
                        <button class="login_button" type="submit"> 
                            Sign In
                        </button>
                    </div>
                    <small class="text-muted" style="display: grid; grid-template-columns: repeat(2, 50%);"> 
                        {% comment %}<p style="font-size: 10pt; padding-right: 20%;">Need an account? <a class="ml-2" href="{% url 'register' %}">Sign up!</a></p> {% endcomment %}
                        
                        <a href="#" style="text-align: right; color:rgb(34, 123, 239); top: -100px; font-size: 10pt;">Forgot Password?</a>

                    </small>
                </form>

                <div class="or_split" style="pointer-events: none; margin-block: 1rem;">
                    <div class="or_split_line">
                        <div></div>
                        <div class="border-top pt-3"></div>
                    </div>
                    <p style="font-size: 12pt; transform: translateY(6px); line-height: 60px; height: fit-content; justify-content: center; text-align: center;">
                        OR
                    </p>
                    <div class="or_split_line">
                        <div></div>
                        <div class="border-top pt-3"></div>
                    </div>
                </div>

                {% comment %}

                <div class="border-top pt-3">
                    <p style="text-align: center; justify-self: center; line-height: 4rem; font-size: 12pt;">OR</p>
                </div>

                <a href='{% url "social:begin" "google-oauth2" %}'>Google</a>
                
                {% endcomment %}

                <div class="social_logins" style="padding-bottom: 6.5rem;">
                    
                    
                    
                </div>
                
            <script>
                function password_show_hide() {
                    console.log('hello')
                    var x = document.getElementById("password");
                    var show_eye = document.getElementById("show_eye");
                    var hide_eye = document.getElementById("hide_eye");
                    hide_eye.classList.remove("d-none");
                    if (x.type === "password") {
                        x.type = "text";
                        show_eye.style.display = "none";
                        hide_eye.style.display = "block";
                    } else {
                        x.type = "password";
                        show_eye.style.display = "block";
                        hide_eye.style.display = "none";
                        }
}
            </script>

            <script>
                $('.login_form').submit(function(e){
                    $.post('/sign-in/', $(this).serialize(), function(data){ 
                        //console.log('TEST')
                        console.log(JSON.parse(data).message)
                        if (JSON.parse(data).message == '200') {
                            window.location.href = '/';
                        } 
                        if (JSON.parse(data).message != '200') {
                            console.log('error')
                            var loginText = document.querySelector(".loginSectionTitleText");
                            var loginError = document.querySelector(".login_error");
                            var loginErrorText = document.querySelector(".login_error p");

                            loginText.style.display = `None`;
                            loginError.style.display = `grid`;

                            loginErrorText.textContent=JSON.parse(data).message;

                        }
                    });
                    e.preventDefault();
                });
            </script>
            
          </section>
        
      </body>
  </html>
{% endblock content %}